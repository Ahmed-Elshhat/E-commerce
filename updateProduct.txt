بص انا مش عارف هعمل ال updateProduct ازاي مع التحققات الصارمة اللي انا عاملها  انا كمان عاوز اعمل  لو هوا كان عامل product فية size و ال size دا فية اللوان يقدر يحدث اسم اللون و ال quantity بتاعت اللون و طبعا لو حدث حاجة من الاتنين دول يروح دا يتحدث في سلة كل المستخدمين اللي ضافو المنتج باللون دا في سلتهوم و تعدل الكمية و لو حدث اسم اللون تروح في سلة المستخدم و تقول هذا اللون اصبح غير متوفر و لو غير الكمية بتاعت اللون هي اللي اتحدثت يروح للمستخدمين اللي ضافو المنتج في السلة بتاعتهوم باللون دا بالمقاس دا و يشوف لو الكمية المحجوزة مؤقتا في سلة المستخدم اقل من الكمية الجديدة مش يعمل حاجة و لو اكتشف ان الكمية الجديدة اقل من الكمية المحجوزة يخلي الكمية المحجوزة تفس الكمية المتوفرة و لو الكمية المحجوزة تساوي الكمية الجديدة المحدثة مش يعمل اي حاجة برضو و لو ال size ملوش لون يقدر يحدث ال quantity بتاعت المقاس دا  و برضو لو حدث كمية المقاس دا تروح تتنفذ نفس العملية بتاعت تعديل الكمية المحجوزة بالطريقة اللي شرحتهالك و يقدر يحدث سعر المقاس طبعا حتي لو لية لون و يقدر يحدث السعر بعد الخصم الخاص بالمقاس دا و لو حدث السعر الخاص بالمقاس دا يروح يعدل السعر دا في السلة الخاصة بكل مستخدم ضاف المنتج دا بالمقاس دا في سلتة و يعدل السعر و يعيد حساب ال totalPrice بتاعت ال Cart و نفس النظام لو حدث السعر بعد الخصم و لو حدث اسم ال size يروح في السلة بتاعت كل شخص ضاف المنتج بالمقاس دا في سلته و يقلو المنتج هذا بالمقاس دا لم يعد متوفر و لو المنتج ملوش مقاس بس لية اللوان عامة لو حدث لون من اللوان العامة إذا كان حدث اسم اللون او الكمية بتاعت اللون دا يحصل نفس الكلام الخاص بسلة المستخدمين زي ما عملنا في اللوان المقاس بس المرة دي للالوان العامة يروح برضو لو حدث الكمية بتاعت اللون يروح يحصل نفس العملية في سلة المستخدمين و لو حدث اللون يروح برضو يحدث السلة بتاعت المستخدمين اللي ضافو المنتج باللون دا و يحدث و يقول المنتج بهذا اللون لم يعد متوفر  و كذالك الامر في الكمية العامة لو مفيش مقاسات او اللوان عامة يروح لسلة المستخدمين و يحدث كمية المنتج بناء علي الطريقة اللي بنحدث بيها الكمية في السلة و لو حدث السعر يروح يحدث سعر المنتج في سلةى المستخدمين اللي ضافو المنتج دا في السلة و يعيد حساب ال total price بتاعت السلة وكذا لك الامر مع السعر بعد الخصم العام بالنسبة للالوان لو هوا حدث اسم اللون و كميتة في نفس الوقت مفيش داعي انة يروح يحدث الكمية يكتفي انة يقولة المنتج باللون دا معدش متوفر و كذلك لو حدث الكمية بتاعت المنتج و اسم المنتج في نفس الوقت مش لازم يروح يحدث الكمية هيروح يقولة المنتج ماعدش متوفر  بالمقاس دا و بس و لو هيحذف مقاس يروح لسلة كل واحد ضاف المقاس دا في سلتة و يقول المقاس دا ماعدش متوفر و كذلك لو حذف لون او حذف مقاس او حذف لون عام  و طبعا  الحتة بتاعت لو عاوز يخلي مقاس معين بدون اللوان لازم يبعت حقل اسمة deleteColorsForSize هيعت object في اسم المقاس اللي عاوز يحذف اللوانة كلها مرة واحدة و معاه الكمية الجديدة بتاعت المنتج  و  يبعت كمان في ال object دا النوع deletAllColors طب لو عاوز يحذف لون واحد مش كلهوم يبعت نفس ال الحقل دا deleteColorsForSize  اسم المقاس اللي فية اللون و اسم اللون و لو هوا اخر مقاس مفيش غيرو يبعت الكمية بتاعت المقاس  و النوع deleteOne و لو عاوز يحذف اتنين مثلا  مع بعض برضو في نفس الحقل لازم يبعت اسم المقاس و النوع هيبقي multibuleDelete و ال الكمية لو دول اخر اتين اللوان في المقاس دا و اسماء الالوان اللي عاوز يحذفها طب لو عاوز يحذف مقاس بالالوان اللي جواة لو فية اللوان للمقاس دا بص هيبعت حقل جديد بس اسمة deleteSizes و يبعت اسم المقاس و لو المقاس دا اخر مقاس لازم يبعت الكمية العامة لو مفيش واللوان عامة  و السعر العام و النوع يكون deletAllSizes او  deletOne او multibuleDelete و لازم هيحذف كذا لون لازم بعت اساميهوم  ولازم في كل مرة ميحذف مقاس او مجموعة مقاسات انة يتاكد لو هما اللي هيحذفهوم دول كل المقاسات لازم يكون باعت سعر المنتج و الكمية بتاعتة لو مش بعت اللوان عامة و لو عاوز يبعت اللوان عامة عشان بعد ما يتحذف كل المقاسات يتم الاعتماد عليها هي و طبعا لو بعت الوان عامة مش بيتم الطلب من الكمية لو بعتها بيرجعلة Error  و كل ما يحث الكمية بتاعت الالوان سواء كانت جوا مقاس او اللوان عامة او يتم حذف لون يتم اعادة حساب الكمية الخاصة بالمقاس اللي الون دا تابع لية و كذالك في اللوان العامة يتم اعادة حساب الكمية العامة لو اتحذف لون او تم تعديل كميتة لو لو عاوز يضيف مقاسات تاني لازم يبعت بس الحقل بتاع المقاسات و يكون باعت حقل حذف الالوان العامة بنفس الطريقة عشان يقدر يضيف مقاس و مش يبعت السعر العام او السعر بعد الخصم او الالوان يبعتى بس حقل حذف الالوان بنفس طريقة ال deletColorsForSize ولازم يكون باعت انة عاوز يحذف كل الاوان العامة الحقل بتاع حذف الالوان العامة اسمة deletColors 

بص انا اكيد مسقط حاجة بس لو افتكرتحاجة هقولك طبعا مع التحقيقات اللي قبل كدا عدم تكرار اللون او عدم تكرار المقاسات و السعر و الكمية و العر بعد الخصم سواء كانو عام او تبع مقاس لازم يكون مش سالب و لازم يكون رقم و كذالك في كميات المقاسات